<h1>Welcome to the game</h1>

<script>

$( document ).ready(function() {
  // Select p children where id not empty
  // Make them draggable

  var boardPieces = $( "td > p" ).filter(function( index ) {
      return $( this ).attr( "id" ) !== "empty";
    });
  var emptySquares = $( "td#unoccupied" );

  $( boardPieces ).draggable({
      revert: "invalid",
      containment: "document",
      cursor: "move"
    });

  $( emptySquares ).droppable({
    tolerance: "fit",
    accept: "td > p",
    // classes: {
    //     "ui-droppable-active": "ui-state-highlight"
    // },
    drop: function () {
      alert( "dropped" );
     } 
  });
});
</script>

<div class="gameBoard">
  <table>
    <tbody>
      <% 8.times do |row| %>
        <tr>
          <% 8.times do |col|%>

            <% piece = @game.pieces.
              where(
              x_pos: row, 
              y_pos: col 
              ).first %>

            <% if (row+col) % 2 == 0 %>
              <td id="<%= piece ? "occupied" : "unoccupied" %>" class="whiteSquare"> <p id="<%= piece ? piece.type + "_" + piece.piece_color : "empty" %>"><%= piece ? piece.symbol : ""  %></p> </td>
            <% else %>
              <td id="<%= piece ? "occupied" : "unoccupied" %>" class="blackSquare"> <p id="<%= piece ? piece.type + "_" + piece.piece_color : "empty" %>"><%= piece ? piece.symbol : ""  %></p> </td>
            <% end %>        
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
